---
import Articles from "../../components/Articles.astro";
import BlogPagesList from "../../components/BlogPagesList.astro";
import Categories from "../../components/Categories.astro";
import BaseLayout from "../../layouts/BaseLayout.astro";

export async function getStaticPaths() {
    let response = await fetch('http://localhost:4000/api/blogs');
    let data = await response.json();
    const pages = data.pages;
    const pagesArray = []; 


    for (let i = 1; i <= pages; i++) {
        pagesArray.push(i)        
    }

    return pagesArray.map(( page ) => {
        return{
            params: {page: `page${page}`},
            props: {page},
            fallback: false
        };
    })
};

const { page } = Astro.props;
---

<BaseLayout>
    <Categories />
    <BlogPagesList />
    <Articles page={page}/>
</BaseLayout>

<script>
    import "../../scripts/categorieFilter.js"
</script>
